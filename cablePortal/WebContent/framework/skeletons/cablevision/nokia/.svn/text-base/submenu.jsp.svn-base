<%@ page import="java.util.Iterator, java.util.List, com.bea.netuix.servlets.controls.page.BookPresentationContext, com.bea.portlet.PageURL, com.bea.netuix.servlets.controls.page.PagePresentationContext"%><%@ page session="false" %> <%! final static String BOOK_PRESENTATION_CONTEXT_CLASS = BookPresentationContext.class.getName(); static final String ROOT_FLAG_KEY = BOOK_PRESENTATION_CONTEXT_CLASS + ".root-flag"; static final String MENU_ITEM_KEY = BOOK_PRESENTATION_CONTEXT_CLASS + ".menu-item"; static final String MENU_CLASS_KEY = BOOK_PRESENTATION_CONTEXT_CLASS + ".menu-class"; static final String MENU_ITEM_CLASS_KEY = BOOK_PRESENTATION_CONTEXT_CLASS + ".menu-item-class"; static final String MENU_ITEM_ACTIVE_CLASS_KEY = BOOK_PRESENTATION_CONTEXT_CLASS + ".menu-item-active-class"; static final String MENU_ITEM_LINK_CLASS_KEY = BOOK_PRESENTATION_CONTEXT_CLASS + ".menu-item-link-class";%> <% Boolean isRoot = (Boolean) request.getAttribute(BOOK_PRESENTATION_CONTEXT_CLASS + ".root-flag"); BookPresentationContext bookCtx = (BookPresentationContext) request.getAttribute(BOOK_PRESENTATION_CONTEXT_CLASS + ".menu-item"); String menuClass = (String) request.getAttribute(MENU_CLASS_KEY); String menuItemClass = (String) request.getAttribute(MENU_ITEM_CLASS_KEY); String menuItemActiveClass = (String) request.getAttribute(MENU_ITEM_ACTIVE_CLASS_KEY); String menuItemLinkClass = (String) request.getAttribute(MENU_ITEM_LINK_CLASS_KEY); if (!bookCtx.isHidden()) { if (bookCtx instanceof BookPresentationContext) { List bookChildren = bookCtx.getPagePresentationContexts() ; Iterator it = bookChildren.iterator(); while (it.hasNext()) { PagePresentationContext childPageCtx = (PagePresentationContext) it.next(); if (!childPageCtx.isHidden()) { %><li><a href="<%= PageURL.createPageURL(request, response, childPageCtx.getDefinitionLabel()).toString() %>"><%= childPageCtx.getTitle() %></a><% if (childPageCtx instanceof BookPresentationContext) { %>
<ul><% request.setAttribute(ROOT_FLAG_KEY, Boolean.FALSE); request.setAttribute(MENU_ITEM_KEY, childPageCtx); %><jsp:include page="submenu.jsp"/><% request.removeAttribute(ROOT_FLAG_KEY); request.removeAttribute(MENU_ITEM_KEY); %></ul>
<% } %></li><% } } } } %>
